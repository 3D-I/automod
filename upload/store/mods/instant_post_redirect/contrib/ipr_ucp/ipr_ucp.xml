<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<?xml-stylesheet type="text/xsl" href="../../modx.prosilver.en.xsl"?>
<!--For security purposes, please check: http://www.phpbb.com/mods/ for the latest version of this MOD. Although MODs are checked before being allowed in the MODs Database there is no guarantee that there are no security problems within the MOD. No support will be given for MODs not found within the MODs Database which can be found at http://www.phpbb.com/mods/-->
<mod xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.phpbb.com/mods/xml/modx-1.0.xsd">
	<header>
		<license>http://opensource.org/licenses/gpl-license.php GNU General Public License v2</license>
		<title lang="en-gb">Instant Post Redirect UCP</title>
		<description lang="en-gb"><![CDATA[This is an alternative version of "Instant Post Redirect", that allows the users to decide if they want to use fast redirection, or not. It does not require instant post redirect to be installed.]]></description>
		<author-notes lang="en-gb"><![CDATA[Nothing]]></author-notes>
		<author-group>
			<author>
				<realname>Igor Wiedler</realname>
				<email>evil@phpbbmodders.net</email>
				<username>eviL&lt;3</username>
				<homepage>http://phpbbmodders.net</homepage>
				<contributions />
			</author>
		</author-group>
		<mod-version>
			<major>1</major>
			<minor>0</minor>
			<revision>2</revision>
		</mod-version>
		<installation>
			<level>easy</level>
			<time>300</time>
			<target-version>
				<target-primary>3.0.RC3</target-primary>
				<target-major allow="exact">3</target-major>
				<target-minor allow="exact">0</target-minor>
			</target-version>
		</installation>
		<history>
			<entry>
				<date>2007-03-23</date>
				<rev-version>
					<major>1</major>
					<minor>0</minor>
					<revision>0</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Initial release</change>
				</changelog>
			</entry>
			<entry>
				<date>2007-05-24</date>
				<rev-version>
					<major>1</major>
					<minor>0</minor>
					<revision>1</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Swaped actions for prosilver &amp; subsilver (thanks Saaiberke)</change>
				</changelog>
			</entry>
			<entry>
				<date>2007-07-02</date>
				<rev-version>
					<major>1</major>
					<minor>0</minor>
					<revision>2</revision>
				</rev-version>
				<changelog lang="en-gb">
					<change>Small picky stuff</change>
					<change>Style changes -> /templates/</change>
				</changelog>
			</entry>
		</history>
	</header>
	<action-group>
		<sql><![CDATA[ALTER TABLE phpbb_users ADD user_ipr INT(1) UNSIGNED NOT NULL DEFAULT '0';]]></sql>
		<open src="posting.php">
			<edit>
				<find><![CDATA[			$redirect_url = submit_post($mode, $post_data['post_subject'], $post_data['username'], $post_data['topic_type'], $poll, $data, $update_message);]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
			if ($user->data['user_ipr'])
			{
				redirect($redirect_url);
			}
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
		</open>
		<open src="adm/style/acp_users_prefs.html">
			<edit>
				<find><![CDATA[		<dd><input type="radio" class="radio" name="popuppm" value="1"<!-- IF POPUP_PM --> id="popuppm" checked="checked"<!-- ENDIF --> />&nbsp; {L_YES} &nbsp;<input type="radio" class="radio" name="popuppm" value="0"<!-- IF not POPUP_PM --> id="popuppm" checked="checked"<!-- ENDIF --> />{L_NO}</dd>
	</dl>]]></find>
				<action type="after-add"><![CDATA[<!-- mod : Instant Post Redirect -->
	<dl> 
		<dt><label for="ipr">{L_USE_IPR}:</label></dt>
		<dd><input type="radio" class="radio" name="ipr" value="1"<!-- IF IPR --> id="ipr" checked="checked"<!-- ENDIF --> />&nbsp; {L_YES} &nbsp;<input type="radio" class="radio" name="ipr" value="0"<!-- IF not IPR --> id="ipr" checked="checked"<!-- ENDIF --> />{L_NO}</dd>
	</dl>
<!-- fin mod : Instant Post Redirect -->]]></action>
			</edit>
		</open>
		<open src="includes/acp/acp_users.php">
			<edit>
				<find><![CDATA[					'notifypm'			=> request_var('notifypm', $user_row['user_notify_pm']),]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
					'ipr'				=> request_var('ipr', $user_row['user_ipr']),
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[							'user_notify_pm'		=> $data['notifypm'],]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
							'user_ipr'				=> $data['ipr'],
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[					'POPUP_PM'			=> $data['popuppm'],]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
					'IPR'				=> $data['ipr'],
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
		</open>
		<open src="includes/ucp/ucp_prefs.php">
			<edit>
				<find><![CDATA[					'notifypm'		=> request_var('notifypm', (bool) $user->data['user_notify_pm']),]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
					'ipr'			=> request_var('ipr', (bool) $user->data['user_ipr']),
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[							'user_notify_pm'		=> $data['notifypm'],]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
							'user_ipr'				=> $data['ipr'],
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
			<edit>
				<find><![CDATA[					'S_NOTIFY_PM'		=> $data['notifypm'],]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
					'S_IPR'				=> $data['ipr'],
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
		</open>
		<open src="language/en/ucp.php">
			<edit>
				<find><![CDATA[	'USER_NOT_FOUND_OR_INACTIVE'	=> 'The usernames you specified could either not be found or are not activated users.',]]></find>
				<action type="after-add"><![CDATA[//-- mod : Instant Post Redirect ------------------------------------------------------------
//-- add
	'USE_IPR'						=> 'Redirect instantly after posting',
//-- fin mod : Instant Post Redirect --------------------------------------------------------]]></action>
			</edit>
		</open>
	</action-group>
</mod>